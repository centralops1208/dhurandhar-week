<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dhurandhar Week Leaderboard</title>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <style>
    body{font-family:system-ui,Arial;margin:20px;background:#fafafa}
    h2{margin:0 0 10px 0}
    .top{display:flex;gap:12px;flex-wrap:wrap;align-items:center;margin-bottom:10px}
    input,select,button{
      padding:10px;
      border:1px solid #ddd;
      border-radius:12px;
      font-size:14px;
      background:#fff;
    }
    input{width:320px;max-width:100%}
    button{cursor:pointer}
    button.active{border-color:#111;font-weight:700}
    .meta{margin-left:auto;font-size:13px;color:#555;display:flex;gap:12px;align-items:center;flex-wrap:wrap}

    table{border-collapse:collapse;width:100%;margin-top:10px;background:#fff;border-radius:14px;overflow:hidden}
    th,td{border:1px solid #eee;padding:12px;text-align:left;vertical-align:middle}
    th{cursor:pointer;background:#f5f5f5;position:sticky;top:0;z-index:1}
    tr:hover{background:#f9f9f9}

    /* Medal bands */
    tr.gold{background:#fff8d1}
    tr.silver{background:#f3f5f7}
    tr.bronze{background:#ffe7d6}

    /* Photo */
    .photoWrap{display:flex;align-items:center;gap:10px}
    .aomImg{
      width:40px;height:40px;border-radius:50%;
      object-fit:cover;border:1px solid #e5e5e5;background:#fff;
      display:block;
    }
    .fallback{
      width:40px;height:40px;border-radius:50%;
      display:inline-flex;align-items:center;justify-content:center;
      border:1px solid #e5e5e5;background:#fafafa;color:#666;font-weight:700;
      font-size:14px;
    }
    .smallNote{font-size:12px;color:#666}
  </style>
</head>

<body>
  <h2>ðŸ”¥ Dhurandhar Week â€“ AOM Leaderboard</h2>

  <div class="top">
    <input id="search" placeholder="Search AOM / Circleâ€¦" />
    <select id="circle">
      <option value="">All Circles</option>
    </select>

    <button id="btnAll" class="active" type="button">All</button>
    <button id="btn10" type="button">Top 10</button>
    <button id="btn50" type="button">Top 50</button>

    <div class="meta">
      <span id="count">Loadingâ€¦</span>
      <span id="updated">Last updated: â€”</span>
    </div>
  </div>

  <div class="smallNote">
    Tip: Add a <b>Photo</b> (or <b>Photo URL</b>) column in Google Sheet to show AOM headshots.
  </div>

  <table id="table">
    <thead></thead>
    <tbody></tbody>
  </table>

<script>
const CSV_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vRUkfZBtB8_vCdr2eD5qh5GJWwuXyrvreI66slaXScut5SS118EUJnC671Pcy4ebpc_g9dZ3D3xpAO-/pub?gid=0&single=true&output=csv";

let rows=[], headers=[];
let sortCol=0, sortDesc=true;
let circleCol="";
let limitMode="all"; // all | top10 | top50

function toNumber(v){
  if(v === null || v === undefined) return NaN;
  const s = String(v).trim().replace(
